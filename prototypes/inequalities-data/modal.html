<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="//cdn.ons.gov.uk/sixteens/cb6733a/css/main.css">
    <link href="https://cdn.ons.gov.uk/sixteens/658deeb/css/work-in-progress.css" rel="stylesheet" type="text/css">

    <title>Centre for Equalities and Inclusion: Inequalities data audit</title>

    <style>
        
        /* The Modal (background) */
        .modal {
          display: none; /* Hidden by default */
          position: fixed; /* Stay in place */
          z-index: 1; /* Sit on top */
          padding-top: 100px; /* Location of the box */
          left: 0;
          top: 0;
          width: 100%; /* Full width */
          height: 100%; /* Full height */
          overflow: auto; /* Enable scroll if needed */
          background-color: rgb(0,0,0); /* Fallback color */
          background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }
        
        /* Modal Content */
        .modal-content {
          background-color: #fefefe;
          margin: auto;
          padding: 20px;
          border: 1px solid #888;
          width: 60%;
        }
        
        /* The Close Button */
        .close {
          color: #aaaaaa;
          float: right;
          font-size: 28px;
          font-weight: bold;
        }
        
        .close:hover,
        .close:focus {
          color: #000;
          text-decoration: none;
          cursor: pointer;
        }
        </style>
</head>

<body class="pl-home">
    <div id="hide">
        <header>
            <a class="skiplink" href="#main" tabindex="0">
                Skip to main content
            </a>
        </header>
        <div class="background--ship-grey">
            <div class="wrapper">
                <div class="padding-top--1 padding-bottom--1">
                    <p class="margin-bottom--0 margin-top--0 font-xsmall"><strong class="banner__tag">Warning</strong>
                        this is a prototype. The content may not be complete or accurate.</p>
                </div>
            </div>
        </div>
        <div class="page-intro background--indigo padding-top-md--4">
            <div class="pl-wrap__inner padding-top-sm--4">
                <div class="wrapper">
                    <h1 class="page-intro__title page-intro__title--home-big padding-bottom-md--4">Inequalities data audit</h1>
                    <p>The results as at 15 October 2018 of an audit of data available on the <a href = "https://www.equalityhumanrights.com/en/equality-act/protected-characteristics" style = "color: #fff; text-decoration: underline">protected characteristics</a>
                        of the Equality Act (2010).</p>
                </div>
            </div>
        </div>
    </div>
    <div class="wrapper">
        <div class="col-wrap">
            <div class="col col--md-one col--lg-one">
                <h2>Filter by domain
                    <select id="myInput" title="Domain" onchange="selectDomain()">
                        <option>All domains</option>
                        <option>Participation</option>
                        <option>Health</option>
                        <option>Justice and Personal Security</option>
                        <option>Work</option>
                        <option>Education</option>
                        <option>Living Standards</option>
                        <option>Other</option>
                    </select>
                </h2>
            </div>
        </div>
        <div class="col-wrap">
            <div class="col col--md-one col--lg-one">
                <h2 class="margin-top-lg--2 margin-top-md--2 margin-top-sm--1">Toggle dimensions covered by data:</h2>
                <div class="col-wrap">
                    <div class="col col--md-6 col--lg-6 margin-left-md--1">
                        <button id="showall" class="btn btn--secondary margin-top-lg--1 margin-top-md--1 margin-top-sm--1 btn--secondary-active"
                            onclick="filterSelection('showall')"> Show
                            all</button>
                    </div>
                    <div class="col col--md-40 col--lg-53">
                        <div id="domainButtons" class="btn-group">
                            <button name="Age" class="btn btn--secondary btn--small margin-top-lg--1 margin-top-md--1 margin-top-sm--1"
                                onclick="filterSelection('Age')"> Age</button>
                            <button name="Sex" class="btn btn--secondary btn--small margin-top-lg--1 margin-top-md--1 margin-top-sm--1"
                                onclick="filterSelection('Sex')"> Sex</button>
                            <button name="Disability" class="btn btn--secondary btn--small margin-top-lg--1 margin-top-md--1 margin-top-sm--1"
                                onclick="filterSelection('Disability')">
                                Disability</button>
                            <button name="Sexual Orientation" class="btn btn--secondary btn--small margin-top-lg--1 margin-top-md--1 margin-top-sm--1"
                                onclick="filterSelection('Sexual Orientation')">
                                Sexual Orientation</button>
                            <button name="Ethnicity" class="btn btn--secondary btn--small margin-top-lg--1 margin-top-md--1 margin-top-sm--1"
                                onclick="filterSelection('Ethnicity')">
                                Ethnicity</button>
                            <button name="Marriage/Civil-Partnership" class="btn btn--secondary btn--small margin-top-lg--1 margin-top-md--1 margin-top-sm--1"
                                onclick="filterSelection('Marriage/Civil-Partnership')">Marriage/Civil-Partnership</button>
                            <button name="Religion/Belief" class="btn btn--secondary btn--small margin-top-lg--1 margin-top-md--1 margin-top-sm--1"
                                onclick="filterSelection('Religion/Belief')">Religion/Belief</button>
                            <button name="Gender reassignment" class="btn btn--secondary btn--small margin-top-lg--1 margin-top-md--1 margin-top-sm--1"
                                onclick="filterSelection('Gender reassignment')">Gender reassignment
                                <button name="Pregnancy/Maternity" class="btn btn--secondary btn--small margin-top-lg--1 margin-top-md--1 margin-top-sm--1"
                                    onclick="filterSelection('Pregnancy/Maternity')">Pregnancy/Maternity</button>
                        </div>


                    </div>
                </div>
            </div>
        </div>

        <br>

        <div class="col-wrap">
            <div class="col col--md-one col--lg-one">
                <div class="markdown-table-container print--avoid-break" style="overflow: scroll;">
                    <figure class="figure" id="table-6cc24a28">
                        <table class="table" id="equalities">
                            <colgroup>
                                <col style="width: 28.3%">
                                <col style="width: 15.9%">
                                <col style="width: 9.8%">
                                <col style="width: 12.6%">
                                <col style="width: 19.2%">
                                <col style="width: 14.2%">
                            </colgroup>
                            <tbody id="tableData">
                                <tr class="table__header-row">
                                    <th scope="col" class="align-left">Dataset</th>
                                    <th scope="col" class="align-left">Domain</th>
                                    <th scope="col" class="align-left">Frequency</th>
                                    <th scope="col" class="align-left">Geographical coverage</th>
                                    <th scope="col" class="align-left">Dimensions</th>
                                    <th scope="col" class="align-left">Find out more</th>
                                </tr>
                            </tbody>
                        </table>
                        <footer class="figure__footer">
                        </footer>
                    </figure>
                </div>
            </div>
            <!-- The Modal -->
<div id="myModal" class="modal">

    <!-- Modal content -->
    <div class="modal-content">
      <span class="close">&times;</span>
      <div id ="modal"></div>
    </div>
  
  </div>

            <script>
                const btns = domainButtons.getElementsByClassName("btn")
                const showAll = document.getElementById('showall')

                function selectDomain() {

                    // Declare variables 
                    let input, filter, table, tr, td, i, txtValue;
                    input = document.getElementById("myInput");
                    if (input.value === "All domains") {
                        filter = ""
                    } else {
                        filter = input.value.toUpperCase();
                    }
                    table = document.getElementById("equalities");
                    tr = table.getElementsByTagName("tr");

                    // Loop through all table rows, and hide those who don't match the search query
                    for (i = 0; i < tr.length; i++) {
                        td = tr[i].getElementsByTagName("td")[1];
                        if (td) {
                            txtValue = td.textContent || td.innerText;
                            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                                tr[i].style.display = "";
                            } else {
                                tr[i].style.display = "none";
                            }
                        }
                    }
                }

                function filterSelection(c) {
                    // Declare variables 
                    let input, filter, table, tr, td, i, txtValue;

                    input = c;
                    filter = input.toUpperCase();
                    table = document.getElementById("equalities");
                    tr = table.getElementsByTagName("tr");
                    // Loop through all table rows, and hide those who don't match the search query
                    for (i = 0; i < tr.length; i++) {
                        td = tr[i].getElementsByTagName("td")[4];
                        if (td) {
                            txtValue = td.textContent || td.innerText;
                            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                                //tr[i].style.display = "";                             
                            } else {
                                tr[i].style.display = "none";
                                if (c === "showall") {
                                    tr[i].style.display = "";
                                }
                            }
                        }
                    }

                    if (c === "showall") {
                        showAll.className += " btn--secondary-active";
                    }

                    for (b = 0; b < btns.length; b++) {
                        if (c === "showall") {
                            btns[b].className = btns[b].className.replace(" btn--secondary-active", "")
                        } else if (btns[b].name === c) {
                            btns[b].className += " btn--secondary-active";
                            showAll.className = showAll.className.replace(" btn--secondary-active", "")
                        }
                    }
                }


                fetch("data/data.json")
                    .then(function (response) {
                        return response.json();
                    })
                    .then(function (myJson) {
                        for (i = 0; i < myJson.length; i++) {
                            tr = createNode("tr");
                            tr.innerHTML = "<tr><td class='align-left' ><a href = " + myJson[i].URL + ">" + myJson[
                                    i].Dataset + "</a></td><td class='align-left' >" + myJson[i].Domain +
                                "</td><td class='align-left'>" + myJson[i].Frequency +
                                "</td><td class='align-left'>" + myJson[i].Geographicalcoverage +
                                "</td><td class='align-left'>" + myJson[i].Dimensions + "</td><td class='align-left'><button class='btn btn--primary-alternative btn--small' id="+ i +" onClick = openModal(id)>Dataset details</button></td></tr>"

                                append(equalities, tr);




                        }
                        
                    });


                function createNode(element) {
                    return document.createElement(element);
                }

                function append(parent, el) {
                    return parent.appendChild(el);
                }

                function openModal(id) {
                    console.log(id)
                    modal = document.getElementById("myModal");
                    console.log(modal)
                    modal.style.display = "block";
                    fetch("data/data.json")
                    .then(function (response) {
                        return response.json();
                    })
                    .then(function (myJson) {
                        console.log (id)
                        key = Object.keys(myJson)[id];
                        value = myJson[key]
                        console.log(value)
                        modalContent = document.getElementById("modal");
                            modalContent.innerHTML = "<h2>Dataset details</h2>" +
                            "<h3>Dataset: <a href = " + value.URL + ">" + value.Dataset + "</a></h3>" + 
                            "<p><b>Domain: </b>" + value.Domain + 
                            "<br><b>Frequency: </b>" + value.Frequency + 
                            "<br><b>Geographical coverage: </b>" + value.Geographicalcoverage +  
                            "<br><b>Dimensions: </b>" + value.Dimensions + 
                            "<p>Can add the rest of the detail about a dataset here</p>"
                    })
                

                    
}
var span = document.getElementsByClassName("close")[0];
// When the user clicks on <span> (x), close the modal
    span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}



            </script>

</html>